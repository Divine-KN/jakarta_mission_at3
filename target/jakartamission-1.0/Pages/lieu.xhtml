<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    
    <h:head>
        <title>Gestion des Lieux</title>
        <style type="text/css">
            :root {
                --couleur-rouge: #CE1126; 
                --couleur-blanc: #FFFFFF;
                --couleur-texte: #333333;
                --couleur-fond-clair: #f9f9f9;
            }

            body { font-family: 'Arial', sans-serif; background-color: var(--couleur-blanc); color: var(--couleur-texte); margin: 0; padding: 20px; text-align: center; }
            h2 { color: var(--couleur-rouge); border-bottom: 3px solid var(--couleur-rouge); padding-bottom: 5px; }

            .form-container { width: 600px; margin: 20px auto; padding: 25px; border: 1px solid #ddd; border-radius: 8px; background-color: var(--couleur-fond-clair); text-align: left; }
            .form-row { display: flex; align-items: flex-start; margin-bottom: 15px; }
            .form-row label { flex-basis: 150px; font-weight: bold; padding-right: 15px; text-align: right; }
            .input-field-container { flex-grow: 1; }
            
            .input-text { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
            
            /* Style du Tableau */
            .table-container { width: 90%; margin: 30px auto; border-collapse: collapse; }
            .table-container th { background-color: var(--couleur-rouge); color: white; padding: 10px; }
            .table-container td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            
            .btn { padding: 5px 12px; border-radius: 4px; cursor: pointer; text-decoration: none; border: none; font-size: 0.9em; margin: 2px; }
            .btn-save { background-color: var(--couleur-rouge); color: white; width: 100%; padding: 10px; }
            .btn-edit { background-color: #2196F3; color: white; }
            .btn-delete { background-color: #f44336; color: white; }
            .nav-link { display: block; margin-top: 20px; color: var(--couleur-rouge); text-decoration: none; font-weight: bold; }
        </style>
    </h:head>

    <h:body>
        <h2>Gestion des Lieux Missions</h2>

        <div class="form-container">
            <h:form id="lieuForm">
                <div class="form-row">
                    <label>Nom :</label>
                    <div class="input-field-container">
                        <h:inputText value="#{lieuBean.nom}" class="input-text" required="true"/>
                    </div>
                </div>

                <div class="form-row">
                    <label>Description :</label>
                    <div class="input-field-container">
                        <h:inputTextarea value="#{lieuBean.description}" rows="3" class="input-text"/>
                    </div>
                </div>

                <div class="form-row">
                    <label>Latitude :</label>
                    <div class="input-field-container">
                        <h:inputText value="#{lieuBean.latitude}" class="input-text"/>
                    </div>
                </div>

                <div class="form-row">
                    <label>Longitude :</label>
                    <div class="input-field-container">
                        <h:inputText value="#{lieuBean.longitude}" class="input-text"/>
                    </div>
                </div>

                <h:commandButton value="Enregistrer / Mettre à jour" action="#{lieuBean.ajouterLieu()}" class="btn btn-save" />
            </h:form>
        </div>

        <h3>Liste des Lieux Enregistrés</h3>
        <h:form>
            <h:dataTable value="#{lieuBean.lieux}" var="l" class="table-container">
                <h:column><f:facet name="header">Nom</f:facet>#{l.nom}</h:column>
                <h:column><f:facet name="header">Description</f:facet>#{l.description}</h:column>
                <h:column><f:facet name="header">Coordonnées</f:facet>#{l.latitude}, #{l.longitude}</h:column>
                <h:column>
                    <f:facet name="header">Actions</f:facet>
                    <h:commandButton value="Modifier" action="#{lieuBean.preparerModification(l)}" class="btn btn-edit">
                        <f:ajax render="lieuForm" />
                    </h:commandButton>
                    
                    <h:commandButton value="Supprimer" action="#{lieuBean.supprimerLieu(l)}" 
                                     onclick="return confirm('Supprimer ce lieu ?')" class="btn btn-delete" />
                </h:column>
            </h:dataTable>
        </h:form>

        <h:link outcome="/index.xhtml" value="← Retourner à l'Accueil" class="nav-link" />
    </h:body>
</html>